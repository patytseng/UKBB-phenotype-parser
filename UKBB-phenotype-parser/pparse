def parse_for_BOLT(in_path,out_path):
    """
    Takes the .tab file for UKBB phenotype data and converts it into the space delimited format required by BOLT-LMM
    :in_path:
    :out_path:
    :return: None
    :example:
    .. jupyter-execute::
        import UKBB-phenotype-parser
        pparse.parse_for_BOLT(in_path,out_path)
    """
    
    line_num = 0

    # opening up the files
    with open(in_path,'r') as in_file:
        with open(out_path,'w') as out_file:
            firstline = True

            # taking each line of the file and processing it
            for line in in_file:
                line = list(line[:-1].split('\t'))
                line = [line[0]] + line

                # correcting header and extracting length of header
                if firstline:
                    line[0] = 'FID'
                    line[1] = 'IID'
                    header_length = len(line)
                    firstline = False

                # confirm line has same number of elements as header
                if len(line) == header_length:

                    # replacing spaces with underscores
                    item_index = 0
                    for item in line:
                        char_index = 0
                        for char in item:

                            if char == ' ':
                                item = item[:char_index] + '_' + item[char_index+1:]
                                line = line[:item_index] + [item] + line[item_index+1:]

                            char_index += 1
                        item_index += 1

                    # creating the new line and writing it
                    line = ' '.join(line) + '\n'
                    out_file.write(line)

                # catching lines with the wrong length
                else:
                    print(line_num)
                line_num += 1